webpackJsonp([27],{"3OQ0":function(t,e,i){"use strict";Object.defineProperty(e,"__esModule",{value:!0});var s=i("gwNS"),n=i("Au9i"),a={data:function(){return{defaultImg:"http://www.bybart.cn/ssm/images/colorbyb.png",popupVisible1:!1,isProduct:!1,isComment:!1,isAddCare:!1,intervalId:0,swiperList:[],desc:{},joinList:[],countDownList:[],comment:"48714",productItems:[],commentList:[],isMore:!1,getGroupDetail:{},number:"1",uid:localStorage.getItem("uId")||0}},created:function(){this.getGroupProductByPId()},computed:{getItemByNum:function(t,e){return function(t,e){for(var i,s=[],n=0;(i=t[n++])&&(s.push(i),!(n>e-1)););return s}}},mounted:function(){},methods:{more:function(){this.joinList.length>0?this.popupVisible1=!0:Object(n.Toast)("暂时还没有可加入的团")},goTeam:function(t){console.log(t),this.isAddCare=!0},joinTeam:function(t){console.log(t),this.isAddCare=!0,document.cookie="groupId="+t.id},goHome:function(){this.$router.push("/group")},getGroupProductByPId:function(){var t=this,e=JSON.parse(localStorage.getItem("groupDetail"));this.getGroupDetail=e,console.log("getGroupProductByPId.params",e);var i=this.$qs.stringify({id:e.id,pImage:e.pImage,pDesc:e.pDesc,pId:e.pId});s.a.getGroupProductByPId(i).then(function(e){console.log("getGroupProductByPId.res",e),t.joinList=e.data.data.billList,t.desc=e.data.data.product,t.desc.count=e.data.data.count,t.swiperList.push({images:e.data.data.product.pImage}),t.joinList.forEach(function(e){var i=Date.parse(new Date),s=Date.parse(new Date(e.gEndtime));t.countDownList.push({remainTime:s-i,remainTimeStr:""})}),t.countdown(),t.getcommentbypid(),t.getProduct()})},getProduct:function(){var t=this;s.a.getProductByPid({pId:this.getGroupDetail.pId}).then(function(e){console.log(e),0==e.data.productItems.length?t.isProduct=!0:t.productItems=e.data.productItems})},getcommentbypid:function(){var t=this,e=this.$qs.stringify({pId:this.getGroupDetail.pId});s.a.getcommentbypid(e).then(function(e){console.log(e),t.commentList=e.data.data,t.comment=e.data.data.length,0==e.data.data.length&&(t.isComment=!0),t.comment>0?t.isMore=!0:t.isMore=!1})},countdown:function(){var t=this;t.intervalId=setInterval(function(){for(var e=0;e<t.countDownList.length;e++){t.countDownList[e].remainTime-=1e3;var i=t.countDownList[e].remainTime;if(i>0){var s,n=Math.floor(i/864e5),a=Math.floor(i/36e5%24),o=Math.floor(i/6e4%60),r=Math.floor(i/1e3%60);s="距离结束：<b>"+(n=n<10?"0"+n:n)+"</b> 天 <b>"+(a=a<10?"0"+a:a)+"</b>时 <b>"+(o=o<10?"0"+o:o)+"</b> 分 <b>"+(r=r<10?"0"+r:r)+"</b> 秒",t.countDownList[e].remainTimeStr=s}else{t.countDownList.every(function(t,e){return t.remainTime<=0})&&clearInterval(timer),t.countDownList[e].remainTimeStr="距离结束：<b>00</b> 天<b>00</b> 时 <b>00</b> 分 <b>00</b> 秒"}}},1e3)},numSub:function(){this.number<=1?Object(n.Toast)({message:"当前已是最小成交数量",position:"bottom",duration:2e3}):(this.number--,this.$emit("input",{res:this.number,other:"--"}))},numAdd:function(){if(this.number){if(this.number>=this.desc.aMaxnum)return void Object(n.Toast)("购买数量不能超过最大限额");this.number++,this.$emit("input",{res:this.number,other:"++"})}},defaultBtn:function(){var t=this;if(this.isAddCare=!1,0==this.uid)this.$router.push("/login");else{var e=this.$qs.stringify({uId:this.uid,count:this.number,pId:this.desc.pId});s.a.addOrderSimple(e).then(function(e){console.log(e),t.$router.push("/buyNow/"+e.data.data.orderid+"/2")}),localStorage.setItem("number",this.number)}}},beforeDestroy:function(){clearInterval(this.intervalId)},destroyed:function(){this.countDownList.forEach(function(t){t.remainTime=0})}},o={render:function(){var t=this,e=t.$createElement,i=t._self._c||e;return i("div",{staticClass:"wrapper"},[i("mt-header",{staticClass:"header",attrs:{fixed:"",title:"商品详情"}},[i("a",{attrs:{slot:"left",href:"javascript:history.go(-1);"},slot:"left"},[i("mt-button",{attrs:{icon:"back"}})],1)]),t._v(" "),i("div",{staticClass:"groupDetail container"},[i("mt-swipe",{staticClass:"swiper",attrs:{auto:4e3}},t._l(t.swiperList,function(e,s){return i("mt-swipe-item",{key:s},[i("img",{attrs:{src:e.images?e.images:"http://www.bybart.cn/ssm/images/byb.png",onerror:t.defaultImg,alt:""}})])}),1),t._v(" "),i("div",{staticClass:"tips"},[t._v(t._s(t.desc.pMember)+" 人团 · 已团"+t._s(t.desc.aNum)+"件")]),t._v(" "),i("div",{staticClass:"detail-desc"},[i("p",{staticClass:"title text-ellipsis"},[t._v(t._s(t.desc.pName))]),t._v(" "),i("div",{staticClass:"price"},[i("b",[t._v("￥"+t._s(t.desc.aNowprice))]),t._v(" "),i("span",[t._v("￥"+t._s(t.desc.aOldprice))])])]),t._v(" "),i("div",{staticClass:"join"},[i("div",{staticClass:"join-top flex-between flex-align-center"},[i("div",[t._v(t._s(t.desc.count)+"人正在开团，新用户可直接参与")]),t._v(" "),i("p",{on:{click:t.more}},[t._v("查看更多 >")])]),t._v(" "),i("div",{staticClass:"join-content"},[i("ul",t._l(t.joinList,function(e,s){return i("li",{key:s,staticClass:"join-list flex-between flex-align-center"},[i("div",{staticClass:"join-desc flex-align-center"},[i("div",{staticClass:"img-box"},[i("img",{attrs:{src:e.uImg?e.uImg:"http://www.bybart.cn/ssm/images/byb.png",alt:e.uName}})]),t._v(" "),i("div",{staticClass:"desc-box"},[i("p",{staticClass:"name"},[t._v(t._s(e.uName))]),t._v(" "),i("p",[t._v("还差 "+t._s(e.redundant)+" 人成团")]),t._v(" "),i("span",{domProps:{innerHTML:t._s(t.countDownList[s].remainTimeStr)}})])]),t._v(" "),i("div",{staticClass:"goJoin",on:{click:function(i){return t.joinTeam(e)}}},[t._v("去参团")])])}),0)])]),t._v(" "),i("div",{staticClass:"datail-box"},[i("p",[t._v("商品详情")]),t._v(" "),i("div",{staticClass:"detail-img",domProps:{innerHTML:t._s(t.desc.pDesc)}})]),t._v(" "),i("div",{staticClass:"datail-box"},[i("p",[t._v("课程内容")]),t._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:t.isProduct,expression:"isProduct"}]},[t._v("暂无课程")]),t._v(" "),i("ul",{directives:[{name:"show",rawName:"v-show",value:!t.getProduct,expression:"!getProduct"}],staticClass:"course"},t._l(t.productItems,function(e,s){return i("li",{key:s,on:{click:function(i){return t.getVideo(e.iPic)}}},[i("div",{staticClass:"flex-align-center"},[i("i",{staticClass:"icon icon-video"}),t._v(" "),i("p",[t._v(t._s(e.iName))])])])}),0)]),t._v(" "),i("div",{staticClass:"comment-box"},[i("div",{staticClass:"flex-between flex-align-center"},[i("h2",[t._v("评价("+t._s(t.comment)+")")]),t._v(" "),i("router-link",{staticClass:"allComment",attrs:{to:{path:"/comment/"+t.desc.pId}}},[t._v("查看全部>")])],1),t._v(" "),i("p",{directives:[{name:"show",rawName:"v-show",value:t.isComment,expression:"isComment"}]},[t._v("\n        暂无评价\n      ")]),t._v(" "),i("ul",{directives:[{name:"show",rawName:"v-show",value:!t.isComment,expression:"!isComment"}],staticClass:"mt"},t._l(t.getItemByNum(t.commentList,1),function(e,s){return i("li",{key:s},[i("div",{staticClass:"flex-align-center flex-between"},[i("div",{staticClass:"info-box flex-align-center"},[i("img",{attrs:{src:e.uimg,alt:""}}),t._v(" "),i("p",[t._v(t._s(e.uName))])]),t._v(" "),i("p",{staticClass:"timer"},[t._v(t._s(e.r1))])]),t._v(" "),i("p",[t._v(t._s(e.cContent))])])}),0),t._v(" "),t.isMore?i("router-link",{staticClass:"more-btn",attrs:{to:{path:"/comment/"+t.desc.pId}}},[t._v("查看更多")]):t._e()],1)],1),t._v(" "),i("div",[i("mt-popup",{staticClass:"popup",attrs:{"popup-transition":"popup-fade"},model:{value:t.popupVisible1,callback:function(e){t.popupVisible1=e},expression:"popupVisible1"}},[i("div",{staticClass:"join"},[i("div",{staticClass:"poptop join-top"},[t._v("正在开团")]),t._v(" "),i("div",{staticClass:"join-content"},[i("ul",t._l(t.joinList,function(e,s){return i("li",{key:s,staticClass:"join-list flex-between flex-align-center"},[i("div",{staticClass:"join-desc flex-align-center"},[i("div",{staticClass:"img-box"},[i("img",{attrs:{src:e.uImg?e.uImg:t.defaultImg,onerror:t.defaultImg,alt:e.uName}})]),t._v(" "),i("div",{staticClass:"desc-box"},[i("p",{staticClass:"name"},[t._v(t._s(e.uName))]),t._v(" "),i("p",[t._v("还差 "+t._s(e.redundant)+" 人成团")]),t._v(" "),i("span",{domProps:{innerHTML:t._s(t.countDownList[s].remainTimeStr)}})])]),t._v(" "),i("div",{staticClass:"goJoin",on:{click:function(i){return t.joinTeam(e)}}},[t._v("去参团")])])}),0)])])])],1),t._v(" "),i("div",{staticClass:"groupdetail-foot"},[i("div",{staticClass:"footer-box"},[i("ul",{staticClass:"flex-between flex-align-center"},[i("li",{staticClass:"flex-align-center",on:{click:t.goHome}},[i("i",{staticClass:"iconfont icon-home"}),t._v("首页\n        ")]),t._v(" "),i("li",{staticClass:"buyNow",on:{click:function(e){return t.goTeam(t.desc)}}},[t._v("\n          ￥"+t._s(t.desc.aNowprice)+"开团 ( 单买价\n          "),i("span",[t._v("￥"+t._s(t.desc.aOldprice))]),t._v(" )\n        ")])])])]),t._v(" "),i("mt-popup",{staticClass:"mint-popup-4",attrs:{"popup-transition":"popup-fade",position:"bottom"},model:{value:t.isAddCare,callback:function(e){t.isAddCare=e},expression:"isAddCare"}},[i("div",{staticClass:"popup-bottom"},[i("div",{staticClass:"detail-box flex-align-center"},[i("img",{attrs:{src:t.desc.pImage,alt:""}}),t._v(" "),i("div",{staticClass:"detail-item"},[i("p",[t._v("￥"+t._s(t.desc.aNowprice))]),t._v(" "),i("span",[t._v("每人限购"+t._s(t.desc.aMaxnum)+"件")])])]),t._v(" "),i("div",{staticClass:"buy-num flex-align-center flex-between"},[i("p",[t._v("数量：")]),t._v(" "),i("div",{staticClass:"input-box flex-align-center"},[i("i",{staticClass:"iconfont icon-move",on:{click:t.numSub}}),t._v(" "),i("input",{directives:[{name:"model",rawName:"v-model",value:t.number,expression:"number"}],staticClass:"input-num",attrs:{type:"number"},domProps:{value:t.number},on:{input:function(e){e.target.composing||(t.number=e.target.value)}}}),t._v(" "),i("i",{staticClass:"iconfont icon-add",on:{click:t.numAdd}})])]),t._v(" "),i("div",{staticClass:"buy-btn",on:{click:function(e){return t.defaultBtn()}}},[t._v("确定")])])])],1)},staticRenderFns:[]};var r=i("VU/8")(a,o,!1,function(t){i("XWlR")},null,null);e.default=r.exports},XWlR:function(t,e){}});